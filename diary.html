<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Diary</title>
<link rel="stylesheet" href="style.css">
</head>
<body class="diary-page">

<!-- HEADER / TOP BANNER -->
<div id="header">
  <div class="top-row">
    <div class="left">
      <img src="images/avatar.png" alt="Avatar">
      <span>title</span>
    </div>
    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="diary.html">Diary</a></li>
        <li><a href="football.html">Watford FC</a></li>
      </ul>
    </nav>
  </div>

  <div class="music-row">
    <iframe src="https://open.spotify.com/embed/track/1uLOYD6T0wdpOD8FcgsPuv" 
            allow="encrypted-media" allowtransparency="true"></iframe>
  </div>
</div>

<!-- MAIN CONTENT -->
<div id="content">
  <h1 class="subtitle">Diary</h1>

  <!-- All diary entries -->
  <div id="all-entries"></div>
</div>
  
<script src="diaryData.js"></script>
  
<script>
// -----------------------------
// Render diary entries
// -----------------------------
const container = document.getElementById("all-entries");

diaryData.forEach((entry, i) => {
  entry.currentVideo = 0;
  entry.currentImage = 0;

  let html = `<div class="box entry" style="width:100%; min-height:300px;">
                <h3 class="subtitle">${entry.date}</h3>`;

  // Split text into paragraphs
  entry.text.split("\n\n").forEach(paragraph => {
    html += `<p>${paragraph}</p>`;
  });

  // -----------------------------
  // Images first
  // -----------------------------
  if (entry.images.length) {
    html += `
      <img id="image-${i}" src="${entry.images[0]}" alt="Diary Image" style="max-width:580px; width:100%; height:auto; display:block; margin:12px auto;">
      <div style="margin-bottom:12px; text-align:center;">
        <button onclick="prevImage(${i})">← Prev</button>
        <span id="image-counter-${i}">1 / ${entry.images.length}</span>
        <button onclick="nextImage(${i})">Next →</button>
      </div>
    `;
  }

  // -----------------------------
  // Videos second
  // -----------------------------
  if (entry.videos.length) {
    html += `
      <video id="video-${i}" controls preload="metadata" style="width:100%; max-width:750px; margin:12px auto;">
        <source src="${entry.videos[0].src}" type="video/mp4">
      </video>
      <div class="video-controls" style="margin-bottom:5px;text-align:center;">
        <button onclick="prevVideo(${i})">← Prev</button>
        <span id="video-counter-${i}" style="font-size:13px;">1 / ${entry.videos.length}</span>
        <button onclick="nextVideo(${i})">Next →</button>
      </div>
      <p id="video-caption-${i}" class="caption">${entry.captions[0] || ""}</p>
    `;
  }

  html += `</div>`;
  container.innerHTML += html;
});


// -----------------------------
// Video navigation
// -----------------------------
function prevVideo(index) {
  const entry = diaryData[index];
  entry.currentVideo = (entry.currentVideo - 1 + entry.videos.length) % entry.videos.length;
  updateVideoPlayer(index);
}

function nextVideo(index) {
  const entry = diaryData[index];
  entry.currentVideo = (entry.currentVideo + 1) % entry.videos.length;
  updateVideoPlayer(index);
}

function updateVideoPlayer(index) {
  const entry = diaryData[index];
  const videoEl = document.getElementById(`video-${index}`);
  videoEl.src = entry.videos[entry.currentVideo].src;
  document.getElementById(`video-counter-${index}`).textContent = 
      `${entry.currentVideo + 1} / ${entry.videos.length}`;

  const captionEl = document.getElementById(`video-caption-${index}`);
  if (captionEl) {
    captionEl.textContent = entry.captions[entry.currentVideo] || "";
  }

  videoEl.load();
}

// -----------------------------
// Image navigation
// -----------------------------
function prevImage(index) {
  const entry = diaryData[index];
  entry.currentImage = (entry.currentImage - 1 + entry.images.length) % entry.images.length;
  updateImage(index);
}

function nextImage(index) {
  const entry = diaryData[index];
  entry.currentImage = (entry.currentImage + 1) % entry.images.length;
  updateImage(index);
}

function updateImage(index) {
  const entry = diaryData[index];
  document.getElementById(`image-${index}`).src = entry.images[entry.currentImage];
  document.getElementById(`image-counter-${index}`).textContent =
    `${entry.currentImage + 1} / ${entry.images.length}`;
}

// -----------------------------
// Visitor counter
// -----------------------------
let count = localStorage.getItem("hitCount") || 0;
count = parseInt(count) + 1;
localStorage.setItem("hitCount", count);
const counterWrapper = document.createElement("div");
counterWrapper.id = "hit-counter-wrapper";
counterWrapper.innerHTML = `Visitors: <span id="counter-display">${count}</span>`;
document.body.appendChild(counterWrapper);
</script>

<footer>
  <p>© 2026 My Site</p>
</footer>

</body>
</html>
