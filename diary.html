<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Diary</title>
<link rel="stylesheet" href="style.css">
</head>
<body class="diary-page">

<!-- HEADER / TOP BANNER -->
<div id="header">
  <div class="top-row">
    <div class="left">
      <img src="images/avatar.png" alt="Avatar">
      <span>title</span>
    </div>
    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="diary.html">Diary</a></li>
        <li><a href="football.html">Watford FC</a></li>
      </ul>
    </nav>
  </div>

  <div class="music-row">
    <iframe src="https://open.spotify.com/embed/track/1uLOYD6T0wdpOD8FcgsPuv" 
            allow="encrypted-media" allowtransparency="true"></iframe>
  </div>
</div>

<!-- MAIN CONTENT -->
<div id="content">
  <h1 class="subtitle">Diary</h1>

  <!-- All diary entries -->
  <div id="all-entries"></div>
</div>

<script>
// -----------------------------
// Diary data
// -----------------------------
const diaryData = [
  {
    date: "Wednesday, 31 December 2025 - Thursday, 1 January 2026",
    text: `Grabbed a pint with old school mates at the Garden Gate - £8 for a Madri is shocking. Head to Olivia’s for a lovely dinner. The alcohol is struggling to fight the mac n cheese and I’m feeling sober - too sober.

It’s time to go dance. Wait for a bus that’s full, so I grab a cheap Uber. Arrive at the Dome, meet Raya and Hana, get inside - it's pretty quiet. Eventually discover there’s another floor, which everyone floods to when it opens.

There’s a little badge-making stall in the smoking area. I go through magazines and find a cowboy to cut out.

Midnight’s coming. Dance. 10 minutes. Dance. 5 minutes. Dance. Everyone counts down, confetti explodes. It feels great.

The rest of Raya’s co. arrive just after midnight. I’ve spent too much at the bar. We’re oscillating between the dancefloor and smoking area. A guy approaches me outside, and a stilted conversation follows. Turn left and right, my mates are otherwise engaged - there’s nobody to save me. He whispers into my ear ‘Next on Channel 4, a new episode of Gogglebox’ (something like that), in a strangely familiar voice. When the bloke who does the Channel 4 voiceovers is offering you a bump in the toilet, surely it's a sign the night’s over.

I end up staying a lot later than I thought I’d make it till. Feeling ready to go soon, I check my phone to see missed calls and texts from mum and dad. He’s lost his keys on their night out, so they’re locked out the house. A good reason to leave, and a free cab journey home, they come to pick me up. I say bye to everyone, and go. There’s a Watford game tomorrow, so I set my alarm for midday.`,
    images: ["images/blog-photo1.jpg"],
    videos: [
      "https://archive.org/download/img-8145_202601/IMG_8145.mov",
      "https://archive.org/download/img-8145_202601/IMG_8143.mov",
      "https://archive.org/download/img-8145_202601/IMG_8142.mov",
      "https://archive.org/download/img-8145_202601/IMG_8155.mov"
    ],
    captions: []
  },
  {
    date: "2025-12-30",
    text: "Another diary entry, no video.",
    images: ["images/blog-photo2.jpg"],
    videos: [],
    captions: []
  }
];

// -----------------------------
// Render diary entries
// -----------------------------
const container = document.getElementById("all-entries");

diaryData.forEach((entry, i) => {
  let html = `<div class="box entry" style="width:100%; min-height:300px;">
                <h3 class="subtitle">${entry.date}</h3>`;

  // Split text into paragraphs
  entry.text.split("\n\n").forEach(paragraph => {
    html += `<p>${paragraph}</p>`;
  });

  // Images
  entry.images.forEach(img => {
    html += `<img src="${img}" alt="Diary Image">`;
  });

  // Videos with optional captions
  if (entry.videos.length) {
    html += `<video id="video-${i}" controls preload="metadata" style="width:100%; max-width:1000px;">
               <source src="${entry.videos[0]}" type="video/mp4">
               Your browser does not support the video tag.
             </video>
             <div class="video-controls" style="margin-bottom:5px;">
               <button onclick="prevVideo(${i})">← Prev</button>
               <span id="video-counter-${i}" style="font-size:13px;">1 / ${entry.videos.length}</span>
               <button onclick="nextVideo(${i})">Next →</button>
             </div>
             <p id="video-caption-${i}" class="caption">${entry.captions[0] || ""}</p>`;
  }

  html += `</div>`;
  container.innerHTML += html;

  entry.currentVideo = 0; // track current video
});

// -----------------------------
// Video navigation
// -----------------------------
function prevVideo(index) {
  const entry = diaryData[index];
  entry.currentVideo = (entry.currentVideo - 1 + entry.videos.length) % entry.videos.length;
  updateVideoPlayer(index);
}

function nextVideo(index) {
  const entry = diaryData[index];
  entry.currentVideo = (entry.currentVideo + 1) % entry.videos.length;
  updateVideoPlayer(index);
}

function updateVideoPlayer(index) {
  const entry = diaryData[index];
  const videoEl = document.getElementById(`video-${index}`);
  videoEl.src = entry.videos[entry.currentVideo];
  document.getElementById(`video-counter-${index}`).textContent = 
      `${entry.currentVideo + 1} / ${entry.videos.length}`;

  // Update optional caption
  const captionEl = document.getElementById(`video-caption-${index}`);
  if (captionEl) {
    captionEl.textContent = entry.captions[entry.currentVideo] || "";
  }

  videoEl.load(); // ensure it updates immediately
}

// -----------------------------
// Visitor counter
// -----------------------------
let count = localStorage.getItem("hitCount") || 0;
count = parseInt(count) + 1;
localStorage.setItem("hitCount", count);
const counterWrapper = document.createElement("div");
counterWrapper.id = "hit-counter-wrapper";
counterWrapper.innerHTML = `Visitors: <span id="counter-display">${count}</span>`;
document.body.appendChild(counterWrapper);
</script>

<footer>
  <p>© 2026 My Site</p>
</footer>

</body>
</html>
